:javascript
  (function() {
    if(#{@sample_form.errors.any?}) {
      $("input[id^=note_is_saved]").each(function( index, element ) {
        var isNewNote = !($(element).val() === "true");
        if(isNewNote) {
          // get always first note since we remove it later on
          var noteContainer = $(element).parent().siblings('.note').eq(0)
          var description = $(noteContainer).children('.description').text().trim();
          noteContainer.remove()
          createNote(description);
        }
      });
    }

    $(".clear-note > input[type='checkbox']").on('click', function(e) {
      $(this).closest('.note').hide();
    });

    $("#add-note").on('click', function (e) {
      e.preventDefault()
      var description = $('#new-note').val().trim();
      createNote(description);
    });
  })();

  function createNote(description) {
    var newNote = {
      info: "by #{current_user.full_name}",
      description: description
    };

    if (newNote.description === "") {
      return;
    }

    // clear input
    $('#new-note').val('');

    var note = $('<div>', { class: 'note'})
      .append($('<div>', { class: 'info' }).text(newNote.info))
      .append($('<div>', { class: 'description' }).text(newNote.description))
      .append($('<div>', { class: 'dashed-line' }));

    var inputHidden = $('<input>', {
      type: 'hidden',
      name: 'sample[new_notes][]'
    }).val(newNote.description);

    $('#notes').append(note).append(inputHidden);
  }
